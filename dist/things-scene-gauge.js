!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@hatiolab/things-scene")):"function"==typeof define&&define.amd?define(["exports","@hatiolab/things-scene"],t):t((e=e||self)["things-scene-gauge"]={},e.scene)}(this,function(e,t){"use strict";const l={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"string",label:"value",name:"value",property:"value"},{type:"number",label:"start-value",name:"startValue",observe:function(e){this.parentNode.querySelector("[name=colorStops]").set("property.min",e)},property:"startValue"},{type:"number",label:"end-value",name:"endValue",observe:function(e){this.parentNode.querySelector("[name=colorStops]").set("property.max",e)},property:"endValue"},{type:"number",label:"step",name:"step",property:"step"},{type:"number",label:"step-text-size",name:"stepTextSize",property:"stepTextSize"},{type:"number",label:"sub-step",name:"subStep",property:"subStep"},{type:"number",label:"step-needle-size",name:"stepNeedleSize",property:"stepNeedleSize"},{type:"number",label:"start-angle",name:"startAngle",property:"startAngle"},{type:"number",label:"end-angle",name:"endAngle",property:"endAngle"},{type:"color",label:"text-fill-style",name:"textFillStyle",property:"textFillStyle"},{type:"color",label:"needle-fill-style",name:"needleFillStyle",property:"needleFillStyle"},{type:"color",label:"inner-circle-fill-style",name:"innerCircleFillStyle",property:"innerCircleFillStyle"},{type:"color",label:"step-fill-style",name:"stepFillStyle",property:"stepFillStyle"},{type:"solid-color-stops",label:"color-stops",name:"colorStops",property:{min:0,max:100}},{type:"legend",label:"",name:"toggleOption",property:{label:"Toggle Option"}},{type:"checkbox",label:"show-start-value",name:"showStartValue",property:"showStartValue"},{type:"checkbox",label:"show-end-value",name:"showEndValue",property:"showEndValue"},{type:"checkbox",label:"show-step-line",name:"showStepLine",property:"showStepLine"},{type:"checkbox",label:"show-step-text",name:"showStepText",property:"showStepText"},{type:"checkbox",label:"show-sub-step",name:"showSubStep",property:"showSubStep"},{type:"checkbox",label:"in-text",name:"inText",property:"inText"},{type:"checkbox",label:"anim-from-base",name:"animFromBase"}]};function a(e,t,l,a){e.rotate(t),e.translate(0,-l),e.fillRect(0,.14*-l,a,.175*l),e.translate(0,l),e.rotate(-t)}function o(e,t,l,a){e.rotate(t),e.translate(0,-l),e.fillRect(0,.04*-l,a,.075*l),e.translate(0,l),e.rotate(-t)}function r(e,t,l,a){e.rotate(l),e.translate(0,.83*-a),e.rotate(-l),e.fillText(t,0,0),e.rotate(l),e.translate(0,.83*a),e.rotate(-l)}class n extends(t.ValueHolder(t.Donut)){_draw(e){var{lineWidth:t=20,startValue:l,endValue:n,step:p,subStep:s,startAngle:i=0,endAngle:y=180,fontColor:h="black",showStepText:b=!0,showStartValue:u=!0,showEndValue:c=!0,showStepLine:m=!0,showSubStep:S=!0,inText:d=!0,colorStops:f,fillStyle:x,textFillStyle:w="black",needleFillStyle:g="black",innerCircleFillStyle:T="gray",stepNeedleSize:V=2,stepFillStyle:F,stepTextSize:v,cx:M,cy:z,rx:P,ry:k,ratio:N,animFromBase:I=!1}=this.model;l=Number(l),this.animOnValueChange(this.value,I,l);const R=.0174533/Math.PI,E=P/100*N,C=k/100*N,_=(y-i)/180,O=n-l;if(i=i*R-.5,y=y*R-.5,e.translate(M,z),e.beginPath(),e.ellipse(0,0,Math.abs(P),Math.abs(k),0,(i*Math.PI).toFixed(2),(y*Math.PI).toFixed(2)),this.drawStroke(e),e.ellipse(0,0,Math.abs(E),Math.abs(C),0,(y*Math.PI).toFixed(2),(i*Math.PI).toFixed(2),!0),e.closePath(),f){let t=0,a=0;e.moveTo(0,0),f.forEach(function(o,r,n){e.beginPath();let p=Math.max(Math.min(o.position-l,O),0),s=a||Math.PI*(i+_*t/O);if(a=r===n.length-1?Math.PI*(i+_):Math.PI*(i+_*p/O),t>O||t>p)return!1;e.ellipse(0,0,Math.abs(P),Math.abs(k),0,s,a),e.ellipse(0,0,Math.abs(E),Math.abs(C),0,a,s,!0),e.fillStyle=o.color,e.fill(),t=p})}e.scale(1,k/P),e.beginPath();let A=this.animValue;A=Math.max(Math.min(A,n),l);let B=Math.PI*(_*(A-l)/O+i-.5);if(function(e,t,l){e.rotate(l),e.beginPath(),e.moveTo(.035*t,0),e.lineTo(0,.8*t),e.lineTo(.035*-t,0),e.lineTo(.015*-t,.2*-t),e.lineTo(.015*t,.2*-t),e.rotate(-l)}(e,P,B),e.fillStyle=g,e.fill(),e.beginPath(),e.ellipse(0,0,Math.abs(P)/15,Math.abs(P)/15,0,0,2*Math.PI),e.fillStyle=T,e.fill(),e.fillStyle=F,m){let t=O/p;a(e,Math.PI*(i+.5),.8*P,V);for(let l=1;l<t;l++){let o=Math.PI*(_/t*l+i+.5);a(e,o,.8*P,V)}a(e,Math.PI*(y+.5),.8*P,V)}if(S){let t=O;for(let l=1;l<=t;l++){if(l%p==0||l%s!=0)continue;let a=Math.PI*(_/t*l+i+.5);o(e,a,.8*P,V)}}e.fillStyle=w,e.font=P*v/50+"px arial",e.textBaseline="middle",e.textAlign="center";let L=d?.8:1.35;if(u&&r(e,l,Math.PI*(i+.5),P*L),c&&r(e,n,Math.PI*(y+.5),P*L),b){let t=O/p;for(let a=1;a<t;a++){let o=l+p*a,n=Math.PI*(_/t*a+i+.5);r(e,o,n,P*L)}}e.scale(1,P/k),e.translate(-M,-z)}contains(e,t){var{cx:l,cy:a,rx:o,ry:r}=this.model,n=(e-l)/(2*o-.5),p=(t-a)/(2*r-.5);return n*n+p*p<.25}_post_draw(e){this.drawText(e)}get nature(){return l}}t.Component.register("gauge-circle",n);const p={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"string",label:"value",name:"value",property:"value"},{type:"number",label:"start-value",name:"startValue",observe:function(e){this.parentNode.querySelector("[name=colorStops]").set("property.min",e)},property:"startValue"},{type:"number",label:"end-value",name:"endValue",observe:function(e){this.parentNode.querySelector("[name=colorStops]").set("property.max",e)},property:"endValue"},{type:"number",label:"step",name:"step",property:"step"},{type:"number",label:"step-text-size",name:"stepTextSize",property:"stepTextSize"},{type:"number",label:"sub-step",name:"subStep",property:"subStep"},{type:"number",label:"step-needle-size",name:"stepNeedleSize",property:"stepNeedleSize"},{type:"color",label:"text-fill-style",name:"textFillStyle",property:"textFillStyle"},{type:"color",label:"needle-fill-style",name:"needleFillStyle",property:"needleFillStyle"},{type:"number",label:"needle-size",name:"needleSize",property:"needleSize"},{type:"color",label:"step-fill-style",name:"stepFillStyle",property:"stepFillStyle"},{type:"solid-color-stops",label:"color-stops",name:"colorStops",property:{min:0,max:100}},{type:"legend",label:"",name:"toggleOption",property:{label:"Toggle Option"}},{type:"checkbox",label:"show-start-value",name:"showStartValue",property:"showStartValue"},{type:"checkbox",label:"show-end-value",name:"showEndValue",property:"showEndValue"},{type:"checkbox",label:"show-step-line",name:"showStepLine",property:"showStepLine"},{type:"checkbox",label:"show-step-text",name:"showStepText",property:"showStepText"},{type:"checkbox",label:"show-sub-step",name:"showSubStep",property:"showSubStep"},{type:"checkbox",label:"anim-from-base",name:"animFromBase"}]};class s extends(t.ValueHolder(t.RectPath(t.Shape))){_draw(e){var{startValue:t,endValue:l,step:a,subStep:o,colorStops:r,needleFillStyle:n,stepFillStyle:p,textFillStyle:s,needleSize:i,stepNeedleSize:y,stepTextSize:h,showStepText:b=!0,showStartValue:u=!0,showEndValue:c=!0,showStepLine:m=!0,showSubStep:S=!0,width:d,height:f,top:x,left:w,animFromBase:g=!1}=this.model;t=Number(t),this.animOnValueChange(this.value,g,t);const T=l-t;if(e.translate(w,x),e.beginPath(),e.rect(0,0,d,f),this.drawFill(e),this.drawStroke(e),e.closePath(),r){let l=0;r.forEach(function(a,o,r){e.beginPath();let n,p=Math.max(Math.min(a.position-t,T),0),s=f*l/T;if(n=o===r.length-1||s+f*p/T?f-s:f-f*p/T,l>T||l>p)return!1;e.rect(0,f-s,d,-n),e.fillStyle=a.color,e.fill(),l=p})}e.beginPath();let V=this.animValue;V=Math.max(Math.min(V,l),t);let F=f-(V-t)/T*f;if(i*=4,e.moveTo(1.05*d,F),e.lineTo(1.05*d+i,F+i/2),e.lineTo(1.05*d+i,F-i/2),e.fillStyle=n,e.fill(),e.closePath(),e.fillStyle=p,m){let t=T/a;e.fillRect(0,f,.06*f,y);for(let l=1;l<t;l++){let a=f/t*l;e.fillRect(0,a,.06*f,y)}e.fillRect(0,0,.06*f,y)}if(S){let t=T;e.fillRect(0,0,.027*f,y);for(let l=1;l<=t;l++){if(l%a==0||l%o!=0)continue;let r=f/t*l;e.fillRect(0,r,.027*f,y)}}let v=f*h/150;if(e.fillStyle=s,e.font=v+"px arial",e.textBaseline="middle",e.textAlign="center",u&&e.fillText(t,-v,f),c&&e.fillText(l,-v,0),b){let l=T/a;for(let o=1;o<l;o++){let r=t+Number(a)*o,n=f-f/l*o;e.fillText(r,-v,n)}}e.translate(-w,-x)}_post_draw(e){this.drawText(e)}get nature(){return p}}t.Component.register("gauge-vertical",s);const i={mutable:!1,resizable:!0,rotatable:!0,properties:[{type:"string",label:"value",name:"value",property:"value"},{type:"number",label:"start-value",name:"startValue",observe:function(e){this.parentNode.querySelector("[name=colorStops]").set("property.min",e)},property:"startValue"},{type:"number",label:"end-value",name:"endValue",observe:function(e){this.parentNode.querySelector("[name=colorStops]").set("property.max",e)},property:"endValue"},{type:"number",label:"step",name:"step",property:"step"},{type:"number",label:"step-text-size",name:"stepTextSize",property:"stepTextSize"},{type:"number",label:"sub-step",name:"subStep",property:"subStep"},{type:"number",label:"step-needle-size",name:"stepNeedleSize",property:"stepNeedleSize"},{type:"color",label:"text-fill-style",name:"textFillStyle",property:"textFillStyle"},{type:"color",label:"needle-fill-style",name:"needleFillStyle",property:"needleFillStyle"},{type:"number",label:"needle-size",name:"needleSize",property:"needleSize"},{type:"color",label:"step-fill-style",name:"stepFillStyle",property:"stepFillStyle"},{type:"solid-color-stops",label:"color-stops",name:"colorStops",property:{min:0,max:100}},{type:"legend",label:"",name:"toggleOption",property:{label:"Toggle Option"}},{type:"checkbox",label:"show-start-value",name:"showStartValue",property:"showStartValue"},{type:"checkbox",label:"show-end-value",name:"showEndValue",property:"showEndValue"},{type:"checkbox",label:"show-step-line",name:"showStepLine",property:"showStepLine"},{type:"checkbox",label:"show-step-text",name:"showStepText",property:"showStepText"},{type:"checkbox",label:"show-sub-step",name:"showSubStep",property:"showSubStep"},{type:"checkbox",label:"anim-from-base",name:"animFromBase"}]};class y extends(t.ValueHolder(t.RectPath(t.Shape))){_draw(e){var{startValue:t,endValue:l,step:a,subStep:o,colorStops:r,needleFillStyle:n,stepFillStyle:p,textFillStyle:s,needleSize:i,stepNeedleSize:y,stepTextSize:h,showStepText:b=!0,showStartValue:u=!0,showEndValue:c=!0,showStepLine:m=!0,showSubStep:S=!0,width:d,height:f,top:x,left:w,animFromBase:g=!1}=this.model;t=Number(t),this.animOnValueChange(this.value,g,t);const T=l-t;if(e.translate(w,x),e.beginPath(),e.rect(0,0,d,f),this.drawFill(e),this.drawStroke(e),e.closePath(),r){let l=0;r.forEach(function(a,o,r){e.beginPath();let n,p=Math.max(Math.min(a.position-t,T),0),s=d*l/T;if(n=o==r.length-1||s+d*p/T?d-s:d*p/T,l>T||l>p)return!1;e.rect(s,0,n,f),e.fillStyle=a.color,e.fill(),l=p})}if(e.fillStyle=p,m){let t=T/a,l=.06*d;e.fillRect(0,f-l,y,l);for(let a=1;a<t;a++){let o=d/t*a;e.fillRect(o,f-l,y,l)}e.fillRect(d,f-l,y,l)}if(S){let t=T,l=.027*d;e.fillRect(0,f-l,y,l);for(let r=1;r<=t;r++){if(r%a==0||r%o!=0)continue;let n=d/t*r;e.fillRect(n,f-l,y,l)}}let V=d*h/150;if(e.fillStyle=s,e.font=V+"px arial",e.textBaseline="middle",e.textAlign="center",u&&e.fillText(t,0,f+.75*V),c&&e.fillText(l,d,f+.75*V),b){let l=T/a;for(let o=1;o<l;o++){let r=t+a*o,n=d/l*o;e.fillText(r,n,f+.75*V)}}e.beginPath();let F=this.animValue,v=((F=Math.max(Math.min(F,l),t))-t)/T*d;i*=4,e.moveTo(v,f+1.4*V),e.lineTo(v+i/2,f+i+1.4*V),e.lineTo(v-i/2,f+i+1.4*V),e.fillStyle=n,e.fill(),e.closePath(),e.translate(-w,-x)}_post_draw(e){this.drawText(e)}get nature(){return i}}t.Component.register("gauge-horizon",y),e.GaugeCircle=n,e.GaugeVertical=s,e.GaugeHorizon=y,Object.defineProperty(e,"__esModule",{value:!0})});
